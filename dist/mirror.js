var _load=function(t,e,a,n){t="https://api.github.com"+t,e.access_token=config.token,$.ajax({type:"GET",url:t,data:e,success:function(t,e,n){a(t,n.getResponseHeader("link"))},error:function(t,e,a){n?n():alert("An error occurred ("+t.status+")")}})},_template={user:function(t){var e='<a target="_blank" class="icon-github" href="'+t.html_url+'"></a>';t.blog&&(e+='<a target="_blank" class="icon-link" href="'+t.blog+'"></a>'),t.email&&(e+='<a target="_blank" class="icon-email" href="mailto:'+t.email+'"></a>'),config.behance&&(e+='<a target="_blank" class="icon-behance" href="'+config.behance+'"></a>'),config.dribbble&&(e+='<a target="_blank" class="icon-dribbble" href="'+config.dribbble+'"></a>'),config.instagram&&(e+='<a target="_blank" class="icon-instagram" href="'+config.instagram+'"></a>');var a='<img src="'+t.avatar_url+'" /><h1>'+t.name+"</h1><p>"+config.info+"</p><section>"+e+"</section>";return a},issues:function(t){for(var e="",a=0;a<t.length;a++)e+='<a class="post" href="#'+t[a].number+'"><h1>'+t[a].title+"</h1><time>Updated at<span>"+t[a].updated_at.split("T")[0]+"</span></time></a>";return e},issue:function(t){for(var e,a,n="",s=0;s<t.labels.length;s++)n+='<mark style="background:#'+t.labels[s].color+'">#'+t.labels[s].name+"</mark>";return a=t.comments>0?'<button class="comment load-comments" data-id="'+t.number+'">View Comments</button>':'<a class="comment" href="'+t.html_url+'#new_comment_field" target="_blank">Add Comment</a>',e='<div id="back">&laquo; back to home</div><h1 class="title">'+t.title+'</h1><time class="time">Updated at<span>'+t.updated_at.split("T")[0]+'</span></time><section class="labels">'+n+'</section><section class="main hidden"><article class="content">'+marked(t.body)+"</article></section>"+a},comments:function(t){for(var e='<ul class="comment_list">',a="",n=0;n<t.length;n++)0===n&&(a=t[n].html_url.split("#")[0]),e+='<li><a href="'+t[n].user.html_url+'" target="_blank"><img src="'+t[n].user.avatar_url+'" /></a><section><header><a target="_blank" href="'+t[n].user.html_url+'">'+t[n].user.login+"</a><span>commented on "+t[n].updated_at.split("T")[0]+"</span></header><p>"+marked(t[n].body)+"</p></section></li>";return e+='</ul><a class="comment" href="'+a+'#new_comment_field" target="_blank">Add Comment</a>'}};$(function(t){function e(t){0!=t.length&&(t.text("Loading Comments...").attr("disabled",!0),_load(n+"/"+t.data("id")+"/comments",{},function(e){t.parent().append(_template.comments(e)),t.remove()}))}function a(){_load(n,{creator:config.user,page:i,per_page:config.per_page},function(e,a){i%c===0?(t("#posts").html(_template.issues(e)),r=[]):t("#posts").append(_template.issues(e)),r=r.concat(e),a&&a.indexOf('rel="next"')>0?(t("#next").css("display","block").removeAttr("disabled").text("More Posts"),i++):t("#next").hide(),t("html").removeClass("loading")})}var n="/repos/"+config.user+"/"+config.repo+"/issues",s="/repos/"+config.user+"/"+config.repo+"/issues/",o="/users/"+config.user,i=1,l="lists",r=[],c=Math.ceil(30/parseInt(config.per_page));if(t("#next").on("click",function(){t(this).attr("disabled",!0).text("Loading..."),a()}),location.hash){l="single";var m=parseInt(location.hash.split("#")[1]);m&&(t("#switch > div").removeClass("transition"),setTimeout(function(){t("#switch").addClass("right")},0),_load(s+m,{},function(a){t("#post").html(_template.issue(a)),t("#post pre code").each(function(t,e){hljs.highlightBlock(e)}),t("html").removeClass("loading"),e(t(".load-comments"))},function(){location.href=""}))}else _load(o,{},function(e){t("#user").html(_template.user(e)),a()});t("body").on("click",function(a){a=t(a.target),a.hasClass("comment")&&"BUTTON"==a[0].tagName&&e(a),"back"==a.attr("id")&&("single"==l?location.href="/":history.back())}),t(window).on("hashchange",function(){if("single"==l)return void(location.href="/");var a,n=parseInt(location.hash.split("#")[1]);if(n){for(var s=0;s<r.length;s++)if(r[s].number==n){a=r[s];break}t("#post").html(_template.issue(a)),e(t("#post").find(".load-comments")),t("#post pre code").each(function(t,e){hljs.highlightBlock(e)}),window.scrollTo(0,0),setTimeout(function(){t("#switch").addClass("right"),setTimeout(function(){t("#main").height(window.innerHeight)},400)},0)}else t("#main").css("height","auto"),setTimeout(function(){t("#switch").removeClass("right"),setTimeout(function(){t("#post").html("")},400)},0)})});